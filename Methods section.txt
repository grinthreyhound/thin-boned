Methods  - THIN paper

The data was from the THIN database of UK primary care records.  It was extracted to comprise cases with a new diagnosis of diabetes matched to 4 controls on age, sex, registered healthcare provider and date of record. Data were examined over a three month period prior to the diagnosis of diabetes.
 
The date of diagnosis of diabetes was initially determined as the first date upon which the patient record was coded with diabetes.  There may be reporting delays if a practitioner suspects diabetes but doesn't code diabetes until investigations are complete.  In order to reduce this the codes that might indicate the practitioner is suspecting diabetes but not recording it have been identified.  Symptom codes were: glycosuria, glycaemia test, hyperglycaemia, hypoglycaemia, urine glucose test, impaired glucose tole, ketonuria and thirst. Test codes were : Fasting glucose, Glucose Tolerance tes, Hb A1C - Diabetic con, Urinalysis - Glucose, Urine dipstick for gl(glucose), Urine dipstick for ke(ketones), Blood glucose, Blood gases, Serum osmolality, Urine Biochemistry and Diabetes annual check.  If any of these codes occurred in the 21 days prior to a diagnosis of diabetes than the earliest date of occurrence was used as an index date.  

NB an example of this is id number:a6802030x had an indexdate of 31st May2000, but had a record dated  30th May 2000 with codes for dehydrated, emergency, dyspnoea and glycosuria. 
NB Also changing to 28 days made no difference to findings.  

The type of diabetes was determined in duplicate, by direct coding and by examining the prescription codes. Codes were present for type 1 diabetes, type 2 diabetes and inconsistent (type 1 and type 2 coded separately in the same record).  Prescriptions within a month of diagnosis were examined as the second method of differentiation.  If a prescription for an insulin was found then type 1 was designated, if it was for a medication used in type 2 diabetes without any insulin (e.g. metformin) then the type was designated type 2. The initial analysis was carried out on a dataset excluding patient records (and matched controls) that had ever been coded as type 2 diabetes, according to either criteria. A sensitivity analysis was pre-planned to use only those specifically coded as type 1 diabetes. 

Sensitivity analyses were undertaken to determine the effect of using cases as their own controls.  In this case the control index date was the record as close to one year earlier as possible.

Incidence rate ratios were estimated using fixed effects poisson regression. Because of selection on date of record the records of the indexdate were not included in the analysis.  Analyses were undertaken using Stata 11. Code is available online. 